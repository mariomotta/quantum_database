\documentclass{report}
\usepackage{epstopdf}
\usepackage{tikz}
\usetikzlibrary{quantikz}

% per produrre le figure finali, scommenta queste linee

\usetikzlibrary{external}
\tikzset{external/system call={latex \tikzexternalcheckshellescape -halt-on-error
-interaction=batchmode -jobname "\image" "\texsource" &&
dvips -o "\image".ps "\image".dvi &&
ps2eps "\image.ps"}}
\tikzexternalize[shell escape=-enable-write18]

% ed esegui da terminale il comando sotto
% latex --shell-escape figure.tex

\begin{document}

\begin{figure}
\hspace{-4cm}
\begin{quantikz}[column sep=0.14cm,row sep=0.2cm]
\lstick{$|x_0 \rangle$} & \gate{R_y^0(\theta_0^0)} & \ctrl{1} & \qw & \qw & \gate{R_y^0(\theta_1^0)} & \qw & \ctrl{1} & \qw & \qw & \gate{R_y^0(\theta_2^0)} & \qw 
& & & & & & & & & & & 
\lstick{$|x_0 \rangle$} & \gate{R_y^0(\theta_0^0)} & \ctrl{1} & \ctrl{2} & \ctrl{3}& \qw & \qw & \qw & \gate{R_y^0(\theta_1^0)} & \ctrl{1} & \ctrl{2} & \ctrl{3}& \qw & \qw & \qw & \gate{R_y^0(\theta_2^0)} & \qw \\
%%%
\lstick{$|x_1 \rangle$} & \gate{R_y^1(\theta_0^1)} & \targ{} & \ctrl{1} & \qw & \gate{R_y^1(\theta_1^1)} & \qw & \targ{} & \ctrl{1} & \qw & \gate{R_y^1(\theta_2^1)} & \qw 
& & & & & & & & & & & 
\lstick{$|x_1 \rangle$} & \gate{R_y^1(\theta_0^1)} & \targ{} & \qw & \qw & \ctrl{1} & \ctrl{2} & \qw & \gate{R_y^1(\theta_1^1)} & \targ{} & \qw & \qw & \ctrl{1} & \ctrl{2} & \qw & \gate{R_y^1(\theta_2^1)} & \qw \\
%%%
\lstick{$|x_2 \rangle$} & \gate{R_y^2(\theta_0^2)} & \qw & \targ{} & \ctrl{1} & \gate{R_y^2(\theta_1^2)} & \qw & \qw & \targ{} & \ctrl{1} & \gate{R_y^2(\theta_2^2)} & \qw 
& & & & & & & & & & & 
\lstick{$|x_2 \rangle$} & \gate{R_y^2(\theta_0^2)} & \qw & \targ{} & \qw & \targ{} & \qw & \ctrl{1} & \gate{R_y^2(\theta_1^2)} & \qw & \targ{} & \qw & \targ{} & \qw & \ctrl{1} & \gate{R_y^2(\theta_2^2)} & \qw \\
%%%
\lstick{$|x_3 \rangle$} & \gate{R_y^3(\theta_0^3)} & \qw & \qw & \targ{} & \gate{R_y^3(\theta_1^3)} & \qw & \qw & \qw & \targ{} & \gate{R_y^3(\theta_2^3)} & \qw 
& & & & & & & & & & & 
\lstick{$|x_3 \rangle$} & \gate{R_y^3(\theta_0^3)} & \qw & \qw & \targ{} & \qw & \targ{} & \targ{} & \gate{R_y^3(\theta_1^3)} & \qw & \qw & \targ{} & \qw & \targ{} & \targ{} & \gate{R_y^3(\theta_2^3)} & \qw \\
\end{quantikz}
\end{figure}

\begin{figure}
\begin{quantikz}[column sep=0.2cm,row sep=0.2cm]
\lstick{$|x_0 \rangle$} & \gate{R_y^0(\theta_0^0)} & \ctrl{1} & \qw & \qw & \gate{R_y^0(\theta_1^0)} & \qw & \qw & \qw & \ctrl{1} & \gate{R_y^0(\theta_1^4)} & \qw & \ctrl{1} & \qw & \qw & \gate{R_y^0(\theta_2^0)} & \qw & \qw & \qw & \ctrl{1} & \gate{R_y^0(\theta_2^4)} & \qw \\
\lstick{$|x_1 \rangle$} & \gate{R_y^1(\theta_0^1)} & \targ{} & \ctrl{1} & \qw & \gate{R_y^1(\theta_1^1)} & \qw & \qw & \ctrl{1} & \targ{} & \gate{R_y^1(\theta_1^5)} & \qw & \targ{} & \ctrl{1} & \qw & \gate{R_y^1(\theta_2^1)} & \qw & \qw & \ctrl{1} & \targ{} & \gate{R_y^1(\theta_2^5)} & \qw \\
\lstick{$|x_2 \rangle$} & \gate{R_y^2(\theta_0^2)} & \qw & \targ{} & \ctrl{1} & \gate{R_y^2(\theta_1^2)} & \qw & \ctrl{1} & \targ{} & \qw & \gate{R_y^2(\theta_1^6)} & \qw & \qw & \targ{} & \ctrl{1} & \gate{R_y^2(\theta_2^2)} & \qw & \ctrl{1} & \targ{} & \qw & \gate{R_y^2(\theta_2^6)} & \qw \\
\lstick{$|x_3 \rangle$} & \gate{R_y^3(\theta_0^3)} & \qw & \qw & \targ{} & \gate{R_y^3(\theta_1^3)} & \qw & \targ{} & \qw & \qw & \gate{R_y^3(\theta_1^7)} & \qw & \qw & \qw & \targ{} & \gate{R_y^3(\theta_2^3)} & \qw & \targ{} & \qw & \qw & \gate{R_y^3(\theta_2^7)} & \qw \\
\end{quantikz}
\end{figure}

\begin{figure}
\hspace{-4.5cm}
\begin{quantikz}[row sep=0.25cm,column sep=0.15cm,font=\large]
& \lstick{$a$}    & \gate[1]{U^{\phantom{\dagger}}_1} & \ctrl{1} & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \ctrl{1} &  \gate[1]{U^\dagger_1} & \qw & & & & & & &
& \lstick{$a$}    & \gate[1]{V^{\phantom{\dagger}}_1} & \ctrl{1} & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \ctrl{1} & \gate[1]{V^\dagger_1} & \qw \\
%
& \lstick{$a-1$} & \qw                                                      & \targ{} & \ctrl{1} & \qw & \qw & \qw & \qw & \qw & \ctrl{1} & \targ & \qw & \qw & \qw & & & & & & &
& \lstick{\dots}  & \qw                                                                                        & \targ{} & \ctrl{1} & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \ctrl{1} & \targ{} & \qw & \qw \\
%
& \lstick{\dots}  & \qw                                                       & \qw & \targ{} & \ctrl{1} & \qw & \qw & \qw & \ctrl{1} & \targ{} & \qw & \qw & \qw & & & & & & &
& \lstick{$b$}    & \gate[1]{V^{\phantom{\dagger}}_2} & \qw & \targ{} & \ctrl{2} & \qw & \qw & \qw & \qw & \qw & \ctrl{2} & \targ & \qw & \qw & \gate[1]{V^\dagger_2} & \qw \\
%
& \lstick{$i+1$} & \qw                                                       & \qw & \qw & \targ{} & \ctrl{1} & \qw & \ctrl{1} & \targ{} & \qw & \qw & \qw & \qw & & & & & & &
& \lstick{\dots}  & \qw                                                                                        & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw \\
%
& \lstick{$i$}     & \gate[1]{U^{\phantom{\dagger}}_2} & \qw & \qw & \qw & \targ{} & \gate[1]{R_z(\theta)} & \targ & \qw & \qw & \qw & \qw &  \gate[1]{U^\dagger_2} & \qw & & & & & & &
& \lstick{$j$}     & \gate[1]{V^{\phantom{\dagger}}_3} & \qw & \qw & \targ{} & \ctrl{1} & \qw & \qw & \qw & \ctrl{1} & \targ{} & \qw & \qw & \gate[1]{V^\dagger_3} & \qw \\
%
&     &  &  &  &  &  &  &  &  &  &  &  &   &  & & & & & &
& \lstick{\dots}  & \qw                                                                                        & \qw & \qw & \qw & \targ{} & \ctrl{1} & \qw & \ctrl{1} & \targ{} & \qw & \qw & \qw & \qw & \qw \\
%
&     &  &  &  &  &  &  &  &  &  &  &  &   &  & & & & & &
& \lstick{$i$}     & \gate[1]{V^{\phantom{\dagger}}_4} & \qw & \qw & \qw & \qw & \targ{} & \gate[1]{R_z(\theta)} & \targ{} & \qw & \qw & \qw & \qw &  \gate[1]{V^\dagger_4} & \qw \\
\end{quantikz}
\end{figure}


\end{document}
